@model Minvu.Snat.Domain.Forms.ConsultaContrato

@{
    ViewBag.Title = "Consulta Solicitud Pago";
}

<div class="container">

    @using (Html.BeginForm("ImprimirSolicitud", "Contrato", FormMethod.Post, new { target = "_blank", id = "formIngresoSolicitud", @class = "form-horizontal", enctype = "multipart/form-data", autocomplete = "off" }))
    {
        var yearNow = @ViewBag.yearNow;
        var dateNow = @ViewBag.dateNow;
        <div id="areaImprimir">
            <div class="container">
                <div class="panel panel-info">
                    <div class="panel-heading">
                        <h2 class="panel-title">PRESUPUESTO REGIONAL</h2>
                    </div>
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-5" for="anno" style="text-align:left">Año Presupuesto:</label>
                                    <div class="col-sm-6">
                                        @Html.TextBoxFor(model => model._contratoSolicitudPago.annoPresupuesto, new { @class = "form-control", maxlength = "8", id = "anno", name = "anno", onpaste = "return false;", onCopy = "return false", onCut = "return false", onDrag = "return false", onDrop = "return false", @Value = yearNow, @readonly = "readonly" })
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-5" for="nSolicitud" style="text-align:left">Número de Solicitud:</label>
                                    <div class="col-md-6">
                                        @Html.TextBoxFor(model => model._contratoSolicitudPago.numeroSolicitudPresupuesto, new { @class = "form-control", id = "nSolicitud", name = "nSolicitud", onpaste = "return false;", onCopy = "return false", onCut = "return false", onDrag = "return false", onDrop = "return false", @readonly = "readonly" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-5" for="pDisponible" style="text-align:left">Presupuesto Disponible<span class="text-justify"> ($)</span>:</label>
                                    <div class="col-sm-6">
                                        @Html.TextBox("pDisponible", Model._contratoSolicitudPago.montoPresupuesto.ToString("N0"), new { @class = "form-control", @readonly = "readonly" })
                                        <input type="text" name="presupuestoDisponibleHidden" id="presupuestoDisponibleHidden" value="" hidden>
                                        <span id="mensajeRut" class="text-danger" style="display:none"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-5" for="nRegionPresupuesto" style="text-align:left">Región:</label>
                                    <div class="col-md-6">
                                        @Html.TextBoxFor(model => model._contratoSolicitudPago.nombreRegionPresupuestoPrint, new { @class = "form-control", id = "nRegionPresupuesto", name = "nRegionPresupuesto", onpaste = "return false;", onCopy = "return false", onCut = "return false", onDrag = "return false", onDrop = "return false", @readonly = "readonly" })
                                        @Html.HiddenFor(model => model._contratoSolicitudPago.idRegion, new { id = "hiddenIdRegion" })
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="container">
                <div class="panel panel-info">
                    <div class="panel-heading">
                        <h2 class="panel-title">CONTRATO / RESOLUCIÓN</h2>
                    </div>
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-5" for="nresolucion" style="text-align:left">N° Resolución Contrato:</label>
                                    <div class="col-sm-6">
                                        @Html.TextBoxFor(model => model._contratoSolicitudPago.numeroResolucionContrato, new { @class = "form-control", placeholder = "Ingrese N° Resolución Contrato", maxlength = "8", id = "nresolucion", name = "nresolucion", onkeypress = "return numeros(event)", onpaste = "return false;", onCopy = "return false", onCut = "return false", onDrag = "return false", onDrop = "return false", @readonly = "readonly", disabled = "disabled" })
                                        @Html.HiddenFor(model => model._contratoSolicitudPago.numeroResolucionContrato, new { id = "nresolucionConsulta" })
                                        @Html.HiddenFor(model => model._contratoSolicitudPago.idContrato, new { id = "hiddenIdContrato" })
                                        <span id="mensajeSpan" class="text-danger" style="display:none"></span>
                                    </div>

                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-5" for="fresolucion" style="text-align:left">Fecha de Resolución Contrato:</label>
                                    <div class="col-md-6">
                                        @*@Html.TextBoxFor(model => model._contratoSolicitudPago.fechaResolucionContrato, new { @class = "form-control", placeholder = "", maxlength = "25", id = "fresolucion", name = "fresolucion", onpaste = "return false;", onCopy = "return false", onCut = "return false", onDrag = "return false", onDrop = "return false", @readonly = "readonly", disabled = "disabled" })*@
                                        @Html.TextBox("fechaResolucion", Model._contratoSolicitudPago.fechaResolucionContrato.ToString("dd-MM-yyyy"), new { @class = "form-control", @readonly = "readonly" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-5" for="pejecucion" style="text-align:left">Plazo Ejecución:</label>
                                    <div class="col-sm-6">
                                        @Html.TextBoxFor(model => model._contratoSolicitudPago.plazoEjecucion, new { @class = "form-control", maxlength = "15", id = "pejecucion", name = "pejecucion", onpaste = "return false;", onCopy = "return false", onCut = "return false", onDrag = "return false", onDrop = "return false", @readonly = "readonly", disabled = "disabled" })
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-5" for="fcontrato" style="text-align:left">Fecha de Inicio Contrato:</label>
                                    <div class="col-md-6">
                                        @*@Html.TextBoxFor(model => model._contratoSolicitudPago.fechaInicioContrato, new { @class = "form-control", placeholder = "", maxlength = "25", id = "fcontrato", name = "fcontrato", onpaste = "return false;", onCopy = "return false", onCut = "return false", onDrag = "return false", onDrop = "return false", @readonly = "readonly", disabled = "disabled" })*@
                                        @Html.TextBox("fechaInicio", Model._contratoSolicitudPago.fechaInicioContrato.ToString("dd-MM-yyyy"), new { @class = "form-control", @readonly = "readonly" })
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-5" for="rut" style="text-align:left">Rut:</label>
                                    <div class="col-sm-6">
                                        @Html.TextBoxFor(model => model._contratoSolicitudPago.rutContrato, new { @class = "form-control", maxlength = "15", id = "rut", name = "rut", onpaste = "return false;", onCopy = "return false", onCut = "return false", onDrag = "return false", onDrop = "return false", @readonly = "readonly", disabled = "disabled" })
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-5" for="nombre" style="text-align:left">Nombre / Razón Social:</label>
                                    <div class="col-md-6">
                                        @Html.TextBoxFor(model => model._contratoSolicitudPago.nombreRazonSocial, new { @class = "form-control", placeholder = "", maxlength = "25", id = "nombreRazonSocial", name = "nombreRazonSocial", onpaste = "return false;", onCopy = "return false", onCut = "return false", onDrag = "return false", onDrop = "return false", @readonly = "readonly", disabled = "disabled" })
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-5" for="tipoProveedor" style="text-align:left">Tipo Proveedor:</label>
                                    <div class="col-sm-6">
                                        @Html.TextBoxFor(model => model._contratoSolicitudPago.nombreTipoProveedor, new { @class = "form-control", maxlength = "15", id = "tipoProveedor", name = "tipoProveedor", onpaste = "return false;", onCopy = "return false", onCut = "return false", onDrag = "return false", onDrop = "return false", @readonly = "readonly", disabled = "disabled" })
                                    </div>
                                </div>
                            </div>

                            @*<div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="control-label col-sm-5" for="montoContrato" style="text-align:left">Monto Contrato<span class="text-justify"> ($)</span>:</label>
                                        <div class="col-md-6">
                                            @Html.TextBoxFor(model => model._contratoSolicitudPago.montoContrato, new { @class = "form-control", placeholder = "", maxlength = "25", id = "montoContrato", name = "montoContrato", onpaste = "return false;", onCopy = "return false", onCut = "return false", onDrag = "return false", onDrop = "return false", @readonly = "readonly", disabled = "disabled" })
                                        </div>
                                    </div>
                                </div>*@
                            @*<div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="control-label col-sm-5" for="nombre" style="text-align:left; text-decoration: underline;">Monto Contrato <span class="text-justify">($)</span></label>
                                    </div>
                                </div>*@
                        </div>
                        <div class="row">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-5" for="nombre" style="text-align:left; text-decoration: underline;"></label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-5" for="montoContrato" style="text-align:left">Monto Contrato <span class="text-justify">($)</span>: </label>
                                    <div class="col-md-6">
                                        @*@Html.TextBoxFor(model => model._contratoSolicitudPago.montoContrato, new { @class = "form-control", placeholder = "", maxlength = "25", id = "montoContrato", name = "montoContrato", onpaste = "return false;", onCopy = "return false", onCut = "return false", onDrag = "return false", onDrop = "return false", @readonly = "readonly", disabled = "disabled" })*@

                                        @Html.TextBox("montoContrato", Model._contratoSolicitudPago.montoContrato.ToString("N0"), new { @class = "form-control", @readonly = "readonly" })
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-6" for="comprometidos" style="text-align:left">Monto Contrato Comprometido <span class="text-justify">($)</span>:</label>
                                    <div class="col-md-6" style="margin-left:-46px">
                                        @*@Html.TextBoxFor(model => model._contratoSolicitudPago.montoComprometidos, new { @class = "form-control", placeholder = "", maxlength = "25", id = "comprometidos", name = "comprometidos", onpaste = "return false;", onCopy = "return false", onCut = "return false", onDrag = "return false", onDrop = "return false", @readonly = "readonly", disabled = "disabled" })*@

                                        @Html.TextBox("montoContrato", Model._contratoSolicitudPago.montoComprometidos.ToString("N0"), new { @class = "form-control", @readonly = "readonly" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-5" for="pagados" style="text-align:left">Monto Contrato Pagado <span class="text-justify">($)</span>:</label>
                                    <div class="col-md-6">
                                        @Html.TextBoxFor(model => model._contratoSolicitudPago.montoPagados, new { @class = "form-control", placeholder = "", maxlength = "25", id = "pagados", name = "pagados", onpaste = "return false;", onCopy = "return false", onCut = "return false", onDrag = "return false", onDrop = "return false", @readonly = "readonly", disabled = "disabled" })
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label class="control-label col-sm-5" for="porPagar" style="text-align:left">Monto Contrato por Pagar <span class="text-justify">($)</span>:</label>
                                    <div class="col-md-6">
                                        @*@Html.TextBoxFor(model => model._contratoSolicitudPago.montoPorPagar, new { @class = "form-control", maxlength = "25", id = "montoPorPagar", name = "montoPorPagar", onpaste = "return false;", onCopy = "return false", onCut = "return false", onDrag = "return false", onDrop = "return false", @readonly = "readonly", disabled = "disabled" })*@

                                        @Html.TextBox("montoContrato", Model._contratoSolicitudPago.montoPorPagar.ToString("N0"), new { @class = "form-control", @readonly = "readonly" })
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="container" id="detallePresupuesto" style='display:block;'>
                <div class="panel panel-info">
                    <div class="panel-heading">
                        <h2 class="panel-title">ACTIVIDADES REALIZADAS</h2>
                    </div>
                    <div class="panel-body" id="detalleActividades">
                        <table id="mytable" class="table table-bordered table-striped" style="width:100%">
                            <thead>
                                <tr>
                                    <th style="text-align:center;">Tipo</th>
                                    <th style="text-align:center;">Servicios</th>
                                    <th style="text-align:center;">Monto a Pagar <span class="text-justify">($)</span></th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (Model != null)
                                {
                                    if (Model._contratoSolicitudPagoList != null)
                                    {
                                        foreach (var items in Model._contratoSolicitudPagoList)
                                        {
                                            <tr>
                                                <td style="text-align:center;">@items.nombreServicio</td>
                                                <td style="text-align:left;">@items.nombreMaestroServicio</td>
                                                <td style="text-align:center;">@items.montoAPagar.ToString("N0")</td>
                                            </tr>
                                        }
                                    }
                                }

                            </tbody>
                        </table>
                        <input type="text" name="dataHidden" id="dataHidden" value="" hidden>
                    </div>
                </div>
            </div>

            <div class="container">
                <div class="panel panel-info">
                    <div class="panel-heading">
                        <h2 class="panel-title">V°B° SERVICIOS</h2>
                    </div>
                    <div class="panel-body" id="detalleServicios">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <div class="control-label col-md-6">
                                        @Html.LabelFor(model => model._auxmaestroTipoPagoEntities.nombreMaestroTipoPago)
                                    </div>
                                    <div class="control-label col-md-6">

                                        <p>@Model._auxmaestroTipoPagoEntities.nombreMaestroTipoPago</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    @if (Model._contratoSolicitudPago.fechaBolFact.ToString() != "")
                                    {
                                        <div class="control-label col-md-6">
                                            @Html.LabelFor(model => model._contratoSolicitudPago.numeroBolFact)
                                        </div>

                                        <div class="control-label col-md-6">
                                            @Html.TextBoxFor(model => model._contratoSolicitudPago.numeroBolFact, new { @class = "form-control", placeholder = "", onkeypress = "return numeros(event)", maxlength = "15", id = "nbolfact", name = "nbolfact", onpaste = "return false;", onCopy = "return false", onCut = "return false", onDrag = "return false", onDrop = "return false", @readonly = "readonly" })
                                            <span id="mensajeNumeroBolFact" class="text-danger" style="display:none">N° Boleta o Factura es obligatorio </span>
                                        </div>
                                    }
                                    else
                                    {
                                        <div class="control-label col-md-6">
                                            @Html.LabelFor(model => model._contratoSolicitudPago.numeroBolFact)
                                        </div>
                                        <div class="control-label col-md-6">
                                            <p >Sin información</p>
                                        </div>


                                    }

                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">

                                    @if (Model._contratoSolicitudPago.fechaBolFact.ToString() != "")
                                    {
                                        <div class="control-label col-md-6">
                                            @Html.LabelFor(model => model._contratoSolicitudPago.fechaBolFact)
                                        </div>

                                        <div class="col-md-6">
                                            @Html.TextBoxFor(model => model._contratoSolicitudPago.fechaBolFact, new { @class = "form-control", placeholder = "Ingrese fecha", id = "vbFecha", name = "vbFecha", onpaste = "return false;", onCopy = "return false", onCut = "return false", onDrag = "return false", onDrop = "return false", @readonly = "readonly" })

                                        </div>
                                    }
                                    else
                                    {
                                        <div class="control-label col-md-6">
                                            @Html.LabelFor(model => model._contratoSolicitudPago.fechaBolFact)
                                        </div>

                                        <div class="control-label col-md-6">
                                            <p>Sin información</p>
                                        </div>
                                    }


                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <div class="control-label col-md-6">
                                        @Html.LabelFor(model => model._contratoSolicitudPago.montoTotalaPagar)
                                    </div>
                                    <div class="control-label col-md-6">
                                        @Html.TextBox("montoContrato", Model._contratoSolicitudPago.montoTotalaPagar.ToString("N0"), new { id = "montoTotalaPagar", @class = "form-control", @readonly = "readonly" })
                                    </div>
                                </div>
                            </div>


                            @if ((Minvu.Security.SingleSignOn.CurrentPrincipal.HasTarea("Atp_Ratificador") || Minvu.Security.SingleSignOn.CurrentPrincipal.HasTarea("Atp_RatificadorReg")) && Model._contratoSolicitudPago.estadoSolicitud == 6)
                            {
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <div class="control-label col-md-6">
                                            @Html.LabelFor(model => model._contratoSolicitudPago.vbServicio)
                                        </div>
                                        <div class="control-label col-md-6">
                                            @Html.CheckBoxFor(Model => Model._contratoSolicitudPago.vbServicio, new { id = "vbServicios" })
                                        </div>
                                    </div>
                                </div>

                            }
                            else if ((Minvu.Security.SingleSignOn.CurrentPrincipal.HasTarea("Atp_Ratificador") || Minvu.Security.SingleSignOn.CurrentPrincipal.HasTarea("Atp_RatificadorReg")) && Model._contratoSolicitudPago.estadoSolicitud == 7)
                            {
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <div class="control-label col-md-6">
                                            @Html.LabelFor(model => model._contratoSolicitudPago.vbServicio)
                                        </div>
                                        <div class="control-label col-md-6">
                                            @Html.CheckBoxFor(Model => Model._contratoSolicitudPago.vbServicio, new { id = "vbServicios", disabled = "disabled" })
                                        </div>
                                    </div>
                                </div>
                            }

                            else
                            {
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <div class="control-label col-md-6">
                                            @Html.LabelFor(model => model._contratoSolicitudPago.vbServicio)
                                        </div>
                                        <div class="control-label col-md-6">
                                            @Html.CheckBoxFor(Model => Model._contratoSolicitudPago.vbServicio, new { id = "vbServicios", disabled = "disabled" })
                                        </div>
                                    </div>
                                </div>
                            }

                            <div class="col-md-4">
                                <div class="form-group">

                                    @if (Model._contratoSolicitudPago.fechaVB.ToString() != "")
                                    {
                                        <div class="control-label col-md-6">
                                            @Html.LabelFor(model => model._contratoSolicitudPago.fechaVB)
                                        </div>

                                        <div class="control-label col-md-6">
                                            <p>@Model._contratoSolicitudPago.fechaVB.ToShortDateString()</p>

                                        </div>
                                    }
                                    else
                                    {
                                        <label class="control-label col-md-6" for="vbFecha" style="text-align:left">Fecha V°B°:</label>
                                        <label class="control-label col-md-6" for="vbFecha" style="text-align:left">Sin información</label>

                                    }




                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <div class="control-label col-md-6">
                                        @Html.LabelFor(model => model._contratoSolicitudPago.vbServicio)
                                    </div>
                                    <div class="col-md-6">
                                        @Html.TextBoxFor(model => model._contratoSolicitudPago.responsableVB, new { @class = "form-control", placeholder = "Ingrese responsable", maxlength = "25", id = "vbResponsable", name = "vbResponsable", onpaste = "return false;", onCopy = "return false", onCut = "return false", onDrag = "return false", onDrop = "return false", @readonly = "readonly" })
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4"></div><div class="col-md-4"></div>
                        </div>


                    </div>
                </div>
            </div>
        </div>
        <div class="container" id="divGuardar">
            <div class="form-group">
                <div class="col-sm-offset-8 col-sm-10">
                    <button type="button" class="btn btn-secondary" onclick="history.back()">Volver</button>
                    @Html.ActionLink("Imprimir", "reporteAutorizacion", "Contrato", new { @class = "btn btn-default" })

                    @*<button type="button" class="btn btn-default" onclick="LimpiaFormulario()">Limpiar</button>*@
                </div>
            </div>
        </div>

        <div class="container" id="divRatificar" style="display:none">
            <div class="form-group">
                <div class="col-sm-offset-8 col-sm-10">
                    <button type="button" class="btn btn-secondary" onclick="history.back()">Volver</button>
                    <button id="btnSubmitRatificar" type="button" class="btn btn-primary">Ratificar</button>
                    @*<button id="btnImprimir" type="button" class="btn btn-warning">Imprimir</button>*@
                    @*<button type="button" class="btn btn-default" onclick="LimpiaFormulario()">Limpiar</button>*@
                </div>
            </div>
        </div>
        <input type="text" name="idEstadoHidden" id="idEstadoHidden" value="6" hidden>

        <div class="container">
            <div class="form-group">
                <div class="col-lg-5" style="text-align:left">
                    Los campos con
                    <span style="color:#FF0000">(*)&nbsp;</span>
                    son obligatorios.<br />
                </div>
            </div>
        </div>
    }

    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true" id="modalOk">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Mensaje</h4>
                </div>
                <div class="modal-body">
                    <div id="divBusqueda" class="alert alert-success oculta" style="display:none">
                        <button class="close" type="button" data-dismiss="alert"></button>
                        <strong id="strongBusqueda">Error</strong>
                    </div>
                    <div id="divBusquedaError" class="alert alert-warning oculta" style="display:none">
                        <button class="close" type="button" data-dismiss="alert"></button>
                        <strong id="strongBusquedaError">Error</strong>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal" id="modal-btn-si">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
    <div class="spinner" style="display:none">
        <div class="center-div">
            <div class="inner-div">
                <div class="loader"></div>
            </div>
        </div>
    </div>
    @using (Html.BeginForm("ImprimirSolicitudModal", "Contrato", FormMethod.Post, new { target = "_blank", id = "formIngresoSolicitud", @class = "form-horizontal", enctype = "multipart/form-data", autocomplete = "off" }))
    {
        <div class="modal fade" id="modalOkRatifica" tabindex="-1" role="dialog" aria-labelledby="edit" aria-hidden="true" data-backdrop="static" data-keyboard="false">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        @*<button type="button" class="close" data-dismiss="modal" aria-hidden="true"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>*@
                        <h4 class="modal-title custom_align" id="Heading">Mensaje</h4>
                    </div>
                    <div class="modal-body">
                        <input type="text" name="idSolicitudHidden" id="idSolicitudHidden" value="" hidden>
                        <input type="text" name="idRegionHidden" id="idRegionHidden" value="" hidden>
                        <input type="text" name="idAnnoHidden" id="idAnnoHidden" value="" hidden>
                        <div id="divBusquedaRat" class="alert alert-success oculta">
                            <button class="close" type="button" data-dismiss="alert"></button>
                            <strong id="strongBusquedaRat">Error</strong>
                        </div>

                    </div>
                    <div class="modal-footer ">
                        @Html.ActionLink("Aceptar", "ListadoSolicitudPago", "Contrato", new { @class = "btn btn-primary" })
                        @*<button type="button" class="btn btn-secondary" data-dismiss="modal"> Aceptar</button>*@
                        @Html.ActionLink("Imprimir", "reporteAutorizacion", "Contrato", new { @class = "btn btn-default" })
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        </div>
    }

</div>
<script>
    $(document).ready(function () {

        if (@Model._auxmaestroTipoPagoEntities.idMaestroTipoPago == 1) {
            $("#vbServicios").attr('disabled', true);
        } else {
            $("#vbServicios").removeAttr('disabled');
        }
    });

    $("#vbServicios").change(function () {

        if (($('#vbServicios').is(':checked'))) {
            document.getElementById('divRatificar').style.display = 'block';
            document.getElementById('divGuardar').style.display = 'none';
            $("#idEstadoHidden").val("7");
        }
        else {
            document.getElementById('divRatificar').style.display = 'none';
            document.getElementById('divGuardar').style.display = 'block';
            $("#idEstadoHidden").val("6");
        }
    });


    $("#btnSubmitRatificar").click(function () {

        var numResolucion = $('#nresolucion').val();
        var anno = $('#anno').val();
        var montoTotal = $('#montoTotalaPagar').val();
        var idSolicitud = $('#nSolicitud').val();
        var responsableVB = $('#vbResponsable').val();
        var codigoRegion = $('#hiddenIdRegion').val();

            if (numResolucion != '') {
                $('.spinner').css('display', 'block');

                $.ajax({
                    type: 'POST',
                    url: '@Url.Action("RatificaSolicitud")', //Llamada al metodo Json
                    dataType: 'json',
                    data: { numeroResolucion: numResolucion, idSolicitud: idSolicitud, anno: anno, idRegion: codigoRegion, montoTotal: montoTotal, vbResponsable: responsableVB },
                    success: function (auxSolicitudPago) {

                        if (auxSolicitudPago._contratoSolicitudPago.idContrato > 0) {

                            $('.spinner').css('display', 'none');
                            $('#modalOkRatifica').modal('toggle');
                            $('#divBusquedaRat').show();
                            $("#strongBusquedaRat").html("Se ha creado exitosamente la autorización de pago N° " + idSolicitud);
                            $('#idSolicitudHidden').val(idSolicitud);
                            $('#idRegionHidden').val(codigoRegion);
                            $('#idAnnoHidden').val(anno);
                        }
                        else
                        {
                            $('.spinner').css('display', 'none');
                            $("#nresolucion").css('border-color', '#b94a48');
                            document.getElementById('mensajeSpan').style.display = 'block';
                            $("#mensajeSpan").html("N° Resolución Contrato no existe o está asociado a otra región.");
                            LimpiaContratoResolucionServicios();
                            return false;
                        }
                    },
                    error: function (ex) {
                        $('.spinner').css('display', 'none');
                        $('#divBusquedaError').show();
                        $("#strongBusquedaError").text("Error inesperado, intente más tarde.");
                    }
                });
                return false;
            }

        });

    window.addEventListener("pageshow", function (event) {
        var historyTraversal = event.persisted ||
            (typeof window.performance != "undefined" &&
                window.performance.navigation.type === 2);
        if (historyTraversal) {
            // Handle page restore.
            window.location.reload();
        }
    });

</script>